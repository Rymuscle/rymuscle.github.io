<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>CSRF (Cross-site request forgery) | Lant&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Safe">
    <meta name="description" content="背景我们知道浏览器的同源策略对用户请求的资源是有一些行为限制的:  Cookie、LocalStorage 和 IndexDB 无法读取 DOM 无法获得  AJAX 请求不能发送  但也有一些就是不在同源策略的限制范围之内; CSRF 跨站点请求伪造CSRF跨站点请求伪造(Cross—Site Request Forgery)跟XSS攻击一样, 存在巨大的危害性, 你可以这样来理解: 攻击者盗用">
<meta name="keywords" content="Safe">
<meta property="og:type" content="article">
<meta property="og:title" content="CSRF (Cross-site request forgery)">
<meta property="og:url" content="http://blog.renyimin.com/2015/05/05/safe-csrf01/index.html">
<meta property="og:site_name" content="Lant&#39;s Blog">
<meta property="og:description" content="背景我们知道浏览器的同源策略对用户请求的资源是有一些行为限制的:  Cookie、LocalStorage 和 IndexDB 无法读取 DOM 无法获得  AJAX 请求不能发送  但也有一些就是不在同源策略的限制范围之内; CSRF 跨站点请求伪造CSRF跨站点请求伪造(Cross—Site Request Forgery)跟XSS攻击一样, 存在巨大的危害性, 你可以这样来理解: 攻击者盗用">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-10-16T06:48:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CSRF (Cross-site request forgery)">
<meta name="twitter:description" content="背景我们知道浏览器的同源策略对用户请求的资源是有一些行为限制的:  Cookie、LocalStorage 和 IndexDB 无法读取 DOM 无法获得  AJAX 请求不能发送  但也有一些就是不在同源策略的限制范围之内; CSRF 跨站点请求伪造CSRF跨站点请求伪造(Cross—Site Request Forgery)跟XSS攻击一样, 存在巨大的危害性, 你可以这样来理解: 攻击者盗用">
    
        <link rel="alternate" type="application/atom+xml" title="Lant&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.6.13">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpeg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lant</h5>
          <a href="mailto:564613464@qq.com" title="564613464@qq.com" class="mail">564613464@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/rymuscle" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">CSRF (Cross-site request forgery)</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">CSRF (Cross-site request forgery)</h1>
        <h5 class="subtitle">
            
                <time datetime="2015-05-05T02:20:16.000Z" itemprop="datePublished" class="page-time">
  2015-05-05
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Safe/">Safe</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#背景"><span class="post-toc-number">1.</span> <span class="post-toc-text">背景</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CSRF-跨站点请求伪造"><span class="post-toc-number">2.</span> <span class="post-toc-text">CSRF 跨站点请求伪造</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CSRF攻击实例"><span class="post-toc-number">3.</span> <span class="post-toc-text">CSRF攻击实例</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CSRF漏洞检测"><span class="post-toc-number">4.</span> <span class="post-toc-text">CSRF漏洞检测</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#防御CSRF攻击"><span class="post-toc-number">5.</span> <span class="post-toc-text">防御CSRF攻击</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#验证-HTTP-Referer-字段"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">验证 HTTP Referer 字段</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#在请求地址中添加-token-并验证"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">在请求地址中添加 token 并验证</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#在-HTTP-头中自定义属性并验证"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">在 HTTP 头中自定义属性并验证</span></a></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-safe-csrf01"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">CSRF (Cross-site request forgery)</h1>
        <div class="post-meta">
            <time class="post-time" title="2015-05-05 10:20:16" datetime="2015-05-05T02:20:16.000Z"  itemprop="datePublished">2015-05-05</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Safe/">Safe</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我们知道浏览器的同源策略对用户请求的资源是有一些行为限制的:</p>
<ol>
<li><code>Cookie</code>、<code>LocalStorage</code> 和 <code>IndexDB</code> 无法读取</li>
<li><code>DOM</code> 无法获得 </li>
<li><code>AJAX</code> 请求不能发送</li>
</ol>
<p>但也有一些就是不在同源策略的限制范围之内;</p>
<h2 id="CSRF-跨站点请求伪造"><a href="#CSRF-跨站点请求伪造" class="headerlink" title="CSRF 跨站点请求伪造"></a>CSRF 跨站点请求伪造</h2><p>CSRF跨站点请求伪造(Cross—Site Request Forgery)跟XSS攻击一样, 存在巨大的危害性, 你可以这样来理解:</p>
<p>攻击者盗用了你的身份，以你的名义发送恶意请求，对服务器来说这个请求是完全合法的;<br>但是却完成了攻击者所期望的一个操作, 比如以你的名义发送邮件、发消息, 盗取你的账号, 添加系统管理员, 甚至于购买商品、虚拟货币转账等;<br>如:</p>
<pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Web A为存在CSRF漏洞的网站;</div><div class="line">Web B为攻击者构建的恶意网站;</div><div class="line">User C为Web A网站的合法用户;</div></pre></td></tr></table></figure>
</code></pre><p>CSRF攻击攻击原理及过程如下:</p>
<pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；</div><div class="line">在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功, 可以正常发送请求到网站A;</div><div class="line">用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B;</div><div class="line">网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A;</div><div class="line">浏览器在接收到这些攻击性代码后,根据网站B的请求,在用户不知情的情况下携带Cookie信息,向网站A发出请求;</div><div class="line">网站A并不知道该请求其实是由B发起的,所以会根据用户C的Cookie信息以C的权限处理该请求,导致来自网站B的恶意代码被执行。</div></pre></td></tr></table></figure>
</code></pre><h2 id="CSRF攻击实例"><a href="#CSRF攻击实例" class="headerlink" title="CSRF攻击实例"></a>CSRF攻击实例</h2><p>受害者 <code>maomao</code> 在银行有一笔存款，通过对银行的网站发送请求 <code>http://bank.example/withdraw?account=maomao&amp;amount=1000000&amp;for=gougou</code> 可以使 <code>maomao</code> 把自己的 1000000 的存款转到 <code>gougou</code> 的账号下;</p>
<p>通常情况下, 该请求发送到网站后, 服务器会先验证该请求是否来自一个合法的 session, 并且该 session 的用户 <code>maomao</code> 已经成功登陆 ;</p>
<p>黑客 <code>feiying</code> 自己在该银行也有账户, 他知道银行网站中的上述 URL 可以对钱进行转帐操作, 于是 <code>feiying</code> 自己发送一个请求给银行: <code>http://bank.example/withdraw?account=maomao&amp;amount=1000000&amp;for=feiying</code>, 但是这个请求来自 <code>feiying</code> 而非 <code>maomao</code>, 他不能通过安全认证，因此该请求不会起作用 ;</p>
<p>但是此时，<code>feiying</code> 想到使用 CSRF 的攻击方式, 他先自己做一个网站, 在网站中放入如下代码: <code>src=&quot;http://bank.example/withdraw?account=maomao&amp;amount=1000000&amp;for=feiying&quot;</code>，并且通过广告等诱使 <code>maomao</code> 来访问他的网站, 当 <code>maomao</code> 访问该网站时, 上述 url 就会从 <code>maomao</code> 的浏览器发向银行, 而这个请求会附带 <code>maomao</code> 浏览器中的 cookie 一起发向银行服务器, 大多数情况下，该请求会失败，<strong>因为他要求 maomao 的认证信息</strong>, 但是，如果 maomao 当时恰巧刚访问他的银行后不久, 他的浏览器与银行网站之间的 session 尚未过期, 浏览器的 cookie 之中含有 maomao 的认证信息;</p>
<p>这时，悲剧发生了，这个 url 请求就会得到响应，钱将从 <code>maomao</code> 的账号转移到 <code>feiying</code> 的账号, 而 <code>maomao</code> 当时毫不知情, 等以后 <code>maomao</code> 发现账户钱少了，即使他去银行查询日志，他也只能发现确实有一个来自于他本人的合法请求转移了资金，没有任何被攻击的痕迹。而 <code>feiying</code> 则可以拿到钱后逍遥法外;</p>
<h2 id="CSRF漏洞检测"><a href="#CSRF漏洞检测" class="headerlink" title="CSRF漏洞检测"></a>CSRF漏洞检测</h2><p>检测CSRF漏洞是一项比较繁琐的工作, 最简单的方法就是抓取一个正常请求的数据包, 去掉Referer字段后再重新提交, 如果该提交还有效, 那么基本上可以确定存在CSRF漏洞 ;</p>
<p>随着对CSRF漏洞研究的不断深入, 不断涌现出一些专门针对CSRF漏洞进行检测的工具, 如<code>CSRFTester</code>, <code>CSRF Request Builder</code>等 ;</p>
<p>以<code>CSRFTester</code>工具为例，CSRF漏洞检测工具的测试原理如下:<br>使用CSRFTester进行测试时, 首先需要抓取我们在浏览器中访问过的所有链接以及所有的表单等信息, 然后通过在CSRFTester中修改相应的表单等信息, 重新提交, 这相当于一次伪造客户端请求;<br>如果修改后的测试请求成功被网站服务器接受, 则说明存在CSRF漏洞, 当然此款工具也可以被用来进行CSRF攻击;</p>
<h2 id="防御CSRF攻击"><a href="#防御CSRF攻击" class="headerlink" title="防御CSRF攻击"></a>防御CSRF攻击</h2><p>目前防御 CSRF 攻击主要有三种策略</p>
<h3 id="验证-HTTP-Referer-字段"><a href="#验证-HTTP-Referer-字段" class="headerlink" title="验证 HTTP Referer 字段"></a>验证 HTTP Referer 字段</h3><p>根据 HTTP 协议, 在 HTTP 头中有一个字段叫 Referer, 它记录了该 HTTP 请求的来源地址;</p>
<p>在通常情况下, 访问一个安全受限页面的请求来自于同一个网站, 比如需要访问 <a href="http://bank.example/withdraw?account=maomao&amp;amount=1000000&amp;for=gougou" target="_blank" rel="external">http://bank.example/withdraw?account=maomao&amp;amount=1000000&amp;for=gougou</a>, 用户必须先登陆 bank.example，然后通过点击页面上的按钮来触发转账事件, 这时，该转帐请求的 Referer 值就会是转账按钮所在的页面的 URL, 通常是以 bank.example 域名开头的地址; </p>
<p>而如果黑客要对银行网站实施 CSRF 攻击，他只能在他自己的网站构造请求，当用户通过黑客的网站发送请求到银行时，该请求的 Referer 是指向黑客自己的网站。因此，要防御 CSRF 攻击，银行网站只需要对于每一个转账请求验证其 Referer 值，如果是以 bank.example 开头的域名，则说明该请求是来自银行网站自己的请求，是合法的, 如果 Referer 是其他网站的话，则有可能是黑客的 CSRF 攻击，拒绝该请求;</p>
<p>这种方法的显而易见的好处就是简单易行，网站的普通开发人员不需要操心 CSRF 的漏洞，只需要在最后给所有安全敏感的请求统一增加一个拦截器来检查 Referer 的值就可以。特别是对于当前现有的系统，不需要改变当前系统的任何已有代码和逻辑，没有风险，非常便捷;</p>
<p>然而，<strong>这种方法并非万无一失</strong>, Referer 的值是由浏览器提供的，虽然 HTTP 协议上有明确的要求，但是每个浏览器对于 Referer 的具体实现可能有差别，并不能保证浏览器自身没有安全漏洞, 使用验证 Referer 值的方法，就是把安全性都依赖于第三方（即浏览器）来保障，从理论上来讲，这样并不安全, 事实上，对于某些浏览器，比如 IE6 或 FF2，目前已经有一些方法可以篡改 Referer 值, 如果 bank.example 网站支持 IE6 浏览器，黑客完全可以把用户浏览器的 Referer 值设为以 bank.example 域名开头的地址，这样就可以通过验证，从而进行 CSRF 攻击 ;<br>即便是使用最新的浏览器，黑客无法篡改 Referer 值，这种方法仍然有问题, 因为 Referer 值会记录下用户的访问来源，有些用户认为这样会侵犯到他们自己的隐私权，特别是有些组织担心 Referer 值会把组织内网中的某些信息泄露到外网中, 因此，用户自己可以设置浏览器使其在发送请求时不再提供 Referer, 当他们正常访问银行网站时，网站会因为请求没有 Referer 值而认为是 CSRF 攻击，拒绝合法用户的访问;</p>
<h3 id="在请求地址中添加-token-并验证"><a href="#在请求地址中添加-token-并验证" class="headerlink" title="在请求地址中添加 token 并验证"></a>在请求地址中添加 token 并验证</h3><p>CSRF 攻击之所以能够成功，是因为黑客可以完全伪造用户的请求，该请求中所有的用户验证信息都是存在于 cookie 中，因此黑客可以在不知道这些验证信息的情况下直接利用用户自己的 cookie 来通过安全验证;</p>
<p>要抵御 CSRF, 关键在于<strong>在请求中放入黑客所不能伪造的信息，并且该信息不存在于 cookie 之中</strong>, 可以在 HTTP 请求中以参数的形式加入一个随机产生的 token, 并在服务器端建立一个拦截器来验证这个 token, 如果请求中没有 token 或者 token 内容不正确, 则认为可能是 CSRF 攻击而拒绝该请求;</p>
<p>这种方法要比检查 Referer 要安全一些, token 可以在用户登陆后产生并放于 session 之中，然后在每次请求时把 token 从 session 中拿出，与请求中的 token 进行比对，但这种方法的难点在于如何把 token 以参数的形式加入请求, 对于 GET 请求，token 将附在请求地址之后，这样 URL 就变成 <a href="http://url?csrftoken=tokenvalue" target="_blank" rel="external">http://url?csrftoken=tokenvalue</a>, 而对于 POST 请求来说，要在 form 的最后加上 <code>&lt;input type=&quot;hidden&quot; name=&quot;csrftoken&quot; value=&quot;tokenvalue&quot;/&gt;</code>, 这样就把 token 以参数的形式加入请求了, 但是, 在一个网站中, 可以接受请求的地方非常多, 要对于每一个请求都加上 token 是很麻烦的, 并且很容易漏掉, 通常使用的方法就是在每次页面加载时, 使用 javascript 遍历整个 dom 树, 对于 dom 中所有的 a 和 form 标签后加入 token, 这样可以解决大部分的请求，但是对于在页面加载之后动态生成的 html 代码，这种方法就没有作用，还需要程序员在编码时手动添加 token ;</p>
<p>该方法还有一个缺点是难以保证 token 本身的安全, 特别是在一些论坛之类支持用户自己发表内容的网站, 黑客可以在上面发布自己个人网站的地址, 由于系统也会在这个地址后面加上 token, 黑客可以在自己的网站上得到这个 token, 并马上就可以发动 CSRF 攻击, 为了避免这一点, 系统可以在添加 token 的时候增加一个判断, 如果这个链接是链到自己本站的, 就在后面添加 token, 如果是通向外网则不加;<br><strong>不过，即使这个 csrftoken 不以参数的形式附加在请求之中, 黑客的网站也同样可以通过 Referer 来得到这个 token 值以发动 CSRF 攻击, 这也是一些用户喜欢手动关闭浏览器 Referer 功能的原因 ;</strong></p>
<h3 id="在-HTTP-头中自定义属性并验证"><a href="#在-HTTP-头中自定义属性并验证" class="headerlink" title="在 HTTP 头中自定义属性并验证"></a>在 HTTP 头中自定义属性并验证</h3><p>这种方法也是使用 token 并进行验证，和上一种方法不同的是，这里并不是把 token 以参数的形式置于 HTTP 请求之中，而是把它放到 HTTP 头中自定义的属性里;<br>通过 XMLHttpRequest 这个类，可以一次性给所有该类请求加上 csrftoken 这个 HTTP 头属性，并把 token 值放入其中, 这样解决了上种方法在请求中加入 token 的不便，同时，通过 XMLHttpRequest 请求的地址不会被记录到浏览器的地址栏，也不用担心 token 会透过 Referer 泄露到其他网站中去;</p>
<p>然而这种方法的局限性非常大, XMLHttpRequest 请求通常用于 Ajax 方法中对于页面局部的异步刷新，并非所有的请求都适合用这个类来发起，而且通过该类请求得到的页面不能被浏览器所记录下，从而进行前进，后退，刷新，收藏等操作，给用户带来不便;<br>另外, 对于没有进行 CSRF 防护的遗留系统来说，要采用这种方法来进行防护，要把所有请求都改为 XMLHttpRequest 请求，这样几乎是要重写整个网站，这代价无疑是不能接受的;</p>
<p><a href="http://blog.csdn.net/stpeace/article/details/53512283" target="_blank" rel="external">原文</a><br><a href="http://blog.csdn.net/qdx411324962/article/details/50235253" target="_blank" rel="external">参考</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        

        
    </div>
    <footer>
        <a href="http://blog.renyimin.com">
            <img src="/img/avatar.jpeg" alt="Lant">
            Lant
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Safe/">Safe</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.renyimin.com/2015/05/05/safe-csrf01/&title=《CSRF (Cross-site request forgery)》 — Lant's Blog&pic=http://blog.renyimin.com/img/avatar.jpeg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.renyimin.com/2015/05/05/safe-csrf01/&title=《CSRF (Cross-site request forgery)》 — Lant's Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.renyimin.com/2015/05/05/safe-csrf01/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《CSRF (Cross-site request forgery)》 — Lant's Blog&url=http://blog.renyimin.com/2015/05/05/safe-csrf01/&via=http://blog.renyimin.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.renyimin.com/2015/05/05/safe-csrf01/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
      <div class="waves-block waves-effect prev">
        <a href="/2015/04/12/web-safe-token/" id="post-prev" class="post-nav-link">
          <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i>Prev </div>
          <h4 class="title">WEB安全之Token浅谈</h4>
        </a>
      </div>
    
  
    <div class="waves-block waves-effect next">
      <a href="/2015/05/15/sameoriginpolicy/" id="post-next" class="post-nav-link">
        <div class="tips">Next<i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">浏览器的同源策略(Same origin policy)</h4>
      </a>
    </div>
  
</nav>



    











<section class="comments" id="comments">
    <div id="gitment_thread"></div>
    <link rel="stylesheet" href="//unpkg.com/gitment/style/default.css">
    <script src="//unpkg.com/gitment/dist/gitment.browser.js"></script>
    <script>
        var gitment = new Gitment({
            owner: 'rymuscle',
            repo: 'rymuscle.github.io',
            oauth: {
                client_id: '49b906f6d47dbab8d929',
                client_secret: '17fd73f24f616a09d4c09bca9480e0deba75a9a2',
            },
        })
        gitment.render('comments')
    </script>
</section>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        赞赏支持
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.png">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Lant &copy; 2015 - 2017</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.renyimin.com/2015/05/05/safe-csrf01/&title=《CSRF (Cross-site request forgery)》 — Lant's Blog&pic=http://blog.renyimin.com/img/avatar.jpeg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.renyimin.com/2015/05/05/safe-csrf01/&title=《CSRF (Cross-site request forgery)》 — Lant's Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.renyimin.com/2015/05/05/safe-csrf01/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《CSRF (Cross-site request forgery)》 — Lant's Blog&url=http://blog.renyimin.com/2015/05/05/safe-csrf01/&via=http://blog.renyimin.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.renyimin.com/2015/05/05/safe-csrf01/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aO3LDMAxFUe1/00qbFJHuA5R4BFxVGY9N8qhAiM9x4Of89vBv8u+nuxQfGTJkvJZxXj7Xh+NbkvWvYTcvSIYMGQsYJBSSEJyGy+sVyNlkyJAhoxUEAZgHXxkyZMhIGbWkNAXLkCFDRprEkstcehH8QC4uQ4aMFzLS7f/z7z/pb8iQIeNVjDN80gZnfzV0KhkyZIxm8ACXNh1rLczaSIcMGTJmM8hyPO3kxyIpKynPHXx7GTJkjGDwIho/ROegJMT/esOVIUPGIMZTCWQ6TpEii9VBGTJkjGDwYz31Cdn3gTELGTJkDGXUBi/4yAVZp1iGkyFDxgJG+nmtqZmW50jh70cuLkOGjKEM3lwkaWetNEbKfOjSKUOGjAWMp1oCnfZAGvTj9yFDhowXMtJjpcGx1p3gu8iQIWMDg2BIzO5cENPmRDHsypAhYxyDjzt0wnE6eHETmmXIkDGU0Ql/tZCajqChRFqGDBmjGTwR7bQNyMq1wbKDR3cZMmQMZaSBuDaikV4u0Q1XhgwZCxhpKa027JWOlMXDFjJkyBjHIIV4fgXsvxTyWxkyZGxgnOGTDnXVrowxVYYMGaMZ6ahWv2FJjkW+T66YMmTImMToNAB40OTvj19VZciQsY0RjDU0WpL9/wA3ubgMGTJkhGW4Wrmfn+rgG8uQIWMZIw3B/QwbjXfIkCFjASNNStMAnQ5Y8AuiDBkyNjD4z/rhOIXVUmsZMmQMYnwBs9NBz8+8CqwAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.6.13"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.6.13" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
